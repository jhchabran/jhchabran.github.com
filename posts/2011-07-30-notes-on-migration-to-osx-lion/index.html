<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Notes on migrating to OSX Lion | jhchabran</title><meta name=keywords content="OSX"><meta name=description content="I bought Lion yesterday ! People have already tested it against tools I use for work : Homebrew, RVM, MacVim so installing it on a friday night shouldn&rsquo;t be too painful. Plus I got backups everywhere (local server + dropbox + github + tarsnap).
{% end_excerpt %}
What went well  Downloading it, I got a stable and fast ADSL connection ( thanks Free.fr ) Installing it right after the download Installing Xcode and Homebrew."><meta name=author content="J.H. Chabran"><link rel=canonical href=http://jhchabran.dev/posts/2011-07-30-notes-on-migration-to-osx-lion/><link crossorigin=anonymous href=/assets/css/stylesheet.min.a65a27fc4e81a2b15f42bbf617e1f4082b6ac47d3a90dd059a1ceaa73557b31b.css integrity="sha256-plon/E6BorFfQrv2F+H0CCtqxH06kN0FmhzqpzVXsxs=" rel="preload stylesheet" as=style><link rel=preload href=./avatar.jpg as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://jhchabran.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://jhchabran.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://jhchabran.dev/favicon-32x32.png><link rel=apple-touch-icon href=http://jhchabran.dev/apple-touch-icon.png><link rel=mask-icon href=http://jhchabran.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><meta property="og:title" content="Notes on migrating to OSX Lion"><meta property="og:description" content="I bought Lion yesterday ! People have already tested it against tools I use for work : Homebrew, RVM, MacVim so installing it on a friday night shouldn&rsquo;t be too painful. Plus I got backups everywhere (local server + dropbox + github + tarsnap).
{% end_excerpt %}
What went well  Downloading it, I got a stable and fast ADSL connection ( thanks Free.fr ) Installing it right after the download Installing Xcode and Homebrew."><meta property="og:type" content="article"><meta property="og:url" content="http://jhchabran.dev/posts/2011-07-30-notes-on-migration-to-osx-lion/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2011-07-30T00:00:00+00:00"><meta property="article:modified_time" content="2011-07-30T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Notes on migrating to OSX Lion"><meta name=twitter:description content="I bought Lion yesterday ! People have already tested it against tools I use for work : Homebrew, RVM, MacVim so installing it on a friday night shouldn&rsquo;t be too painful. Plus I got backups everywhere (local server + dropbox + github + tarsnap).
{% end_excerpt %}
What went well  Downloading it, I got a stable and fast ADSL connection ( thanks Free.fr ) Installing it right after the download Installing Xcode and Homebrew."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://jhchabran.dev/posts/"},{"@type":"ListItem","position":2,"name":"Notes on migrating to OSX Lion","item":"http://jhchabran.dev/posts/2011-07-30-notes-on-migration-to-osx-lion/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Notes on migrating to OSX Lion","name":"Notes on migrating to OSX Lion","description":"I bought Lion yesterday ! People have already tested it against tools I use for work : Homebrew, RVM, MacVim so installing it on a friday night shouldn\u0026rsquo;t be too painful. Plus I got backups everywhere (local server + dropbox + github + tarsnap).\n{% end_excerpt %}\nWhat went well  Downloading it, I got a stable and fast ADSL connection ( thanks Free.fr ) Installing it right after the download Installing Xcode and Homebrew.","keywords":["OSX"],"articleBody":"I bought Lion yesterday ! People have already tested it against tools I use for work : Homebrew, RVM, MacVim so installing it on a friday night shouldn’t be too painful. Plus I got backups everywhere (local server + dropbox + github + tarsnap).\n{% end_excerpt %}\nWhat went well  Downloading it, I got a stable and fast ADSL connection ( thanks Free.fr ) Installing it right after the download Installing Xcode and Homebrew.  FAIL : Uninstalling MacFuse  Uninstalling MacFuse after the install. I forgot to remove it before intalling Lion, since it’s quite unmaintained, you can guess it’s going be boring to remove it correctly. The uninstall script will fail with various errors.  Mailing list thread that sum up what’s going on   Removing it manually, but wait that’s my fault ! I inspected the uninstall shell script and decided to do some quick shell script surgery.  Looks like I messed up there. Even if I manually unplugged the Kext before starting it, I got a weird freeze where no more application could be launched, they were bouncing endlessly. Forced reboot. Lion detects a broken os and decided to re-install itself.    FAIL : Admin privileges  Second install, Lion did not set any admin rights to my main user. This means :  I can’t touch anything in system preferences. I can’t sudo.   Fixed it by booting in single user mode and adding myself manually to admin group :  Reboot and hold cmd+s Remount your partition to have it writable  /sbin/fsck -fy /sbin/mount -uw /   Add myself to admin group  dseeditgroup -o edit -a myusername -t user admin   Reboot    FAIL : SSH encoding issues  SSH’ing into any box messed up completely my encoding settings. Comment *SendEnv LANG LC_* * in */etc/ssh_config* to get back to the pre-Lion behavior. Lion does not set its locale to en_us.utf8 by default, appending it to your ~/.profile with export LC_ALL=en_US.UTF-8 corrects this issue if you want to adapt to the new default.  FAIL : Rvm and Ruby Entreprise edition ( Ree )  Segfault !  ld: warning: directory not found for option '-L/opt/local/lib' ./ext/purelib.rb:2: [BUG] Segmentation fault ruby 1.8.7 (2011-02-18 patchlevel 334) [i686-darwin11.0.0], MBARI 0x6770, Ruby Enterprise Edition 2011.03 fulls logs\n Fixed by using gcc instead of llvm  rvm remove ree export CC=/usr/bin/gcc-4.2 rvm install --force ree StackOverflow thread\nFAIL : Rvm and Postgresql with Homebrew  Fail to exec the Postgresql recipe :  Error: undefined method `strip' for #  I updated and relaunched brew install postgresql which ran smoothly thanks to this fix  FAIL : Fullscreen :  Can’t use cmd+` to alternate windows while in fullscreen, this isn’t vital but it’s quite annoying.  Finally As I wasn’t expecting everything to work for the first time, those small issues did not upset me and weren’t hard to fix. I laughed hard at myself for the macfuse failed surgery where I can only blame myself.\n","wordCount":"476","inLanguage":"en","datePublished":"2011-07-30T00:00:00Z","dateModified":"2011-07-30T00:00:00Z","author":{"@type":"Person","name":"J.H. Chabran"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://jhchabran.dev/posts/2011-07-30-notes-on-migration-to-osx-lion/"},"publisher":{"@type":"Organization","name":"jhchabran","logo":{"@type":"ImageObject","url":"http://jhchabran.dev/favicon.ico"}}}</script></head><body id=top><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=http://jhchabran.dev/ accesskey=h title="jhchabran (Alt + H)">jhchabran</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=http://jhchabran.dev/about/ title=about><span>about</span></a></li><li><a href=http://jhchabran.dev/posts/ title=posts><span>posts</span></a></li><li><a href=http://jhchabran.dev/categories/ title=categories><span>categories</span></a></li><li><a href=http://jhchabran.dev/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Notes on migrating to OSX Lion</h1><div class=post-meta>July 30, 2011&nbsp;·&nbsp;3 min&nbsp;·&nbsp;J.H. Chabran</div></header><div class=post-content><p>I bought Lion yesterday ! People have already tested it against tools I
use
for work : Homebrew, RVM, MacVim so installing it on a friday night
shouldn&rsquo;t
be too painful. Plus I got backups everywhere (local server + dropbox +
github + tarsnap).</p><p>{% end_excerpt %}</p><h2 id=what-went-well>What went well<a hidden class=anchor aria-hidden=true href=#what-went-well>#</a></h2><ul><li>Downloading it, I got a stable and fast ADSL connection ( thanks
Free.fr )</li><li>Installing it right after the download</li><li>Installing Xcode and <a href=http://mxcl.github.com/homebrew/>Homebrew</a>.</li></ul><h2 id=fail--uninstalling-macfuse>FAIL : Uninstalling MacFuse<a hidden class=anchor aria-hidden=true href=#fail--uninstalling-macfuse>#</a></h2><ul><li>Uninstalling <a href=http://code.google.com/p/macfuse/>MacFuse</a> after the
install. I forgot to remove it before
intalling Lion, since it&rsquo;s quite unmaintained, you can guess it&rsquo;s
going be boring to remove it correctly.</li><li>The uninstall script will fail with various errors.<ul><li><a href=http://www.mail-archive.com/macfuse@googlegroups.com/msg01094.html>Mailing list thread that sum up what&rsquo;s going
on</a></li></ul></li><li>Removing it manually, <em>but wait that&rsquo;s my fault !</em> I inspected the
uninstall shell script
and decided to do some quick shell script surgery.<ul><li>Looks like I messed up there. Even if I manually unplugged the Kext
before starting it, I got a weird freeze where no more application
could be launched, they were bouncing endlessly.</li><li>Forced reboot.</li><li>Lion detects a broken os and decided to re-install itself.</li></ul></li></ul><h2 id=fail--admin-privileges>FAIL : Admin privileges<a hidden class=anchor aria-hidden=true href=#fail--admin-privileges>#</a></h2><ul><li>Second install, Lion did not set any admin rights to my main user.
This
means :<ul><li>I can&rsquo;t touch anything in system preferences.</li><li>I can&rsquo;t sudo.</li></ul></li><li>Fixed it by booting in single user mode and adding myself manually to
admin group :<ul><li>Reboot and hold cmd+s</li><li>Remount your partition to have it writable<ul><li><em>/sbin/fsck -fy</em></li><li><em>/sbin/mount -uw /</em></li></ul></li><li>Add myself to admin group<ul><li><em>dseeditgroup -o edit -a myusername -t user admin</em></li></ul></li><li>Reboot</li></ul></li></ul><h2 id=fail--ssh-encoding-issues>FAIL : SSH encoding issues<a hidden class=anchor aria-hidden=true href=#fail--ssh-encoding-issues>#</a></h2><ul><li>SSH&rsquo;ing into any box messed up completely my encoding settings.</li><li>Comment *SendEnv LANG LC_* * in */etc/ssh_config* to get back to the
pre-Lion behavior.</li><li>Lion does not set its locale to <em>en_us.utf8</em> by default,
appending it to your <em>~/.profile</em> with <em>export LC_ALL=en_US.UTF-8</em>
corrects this issue if you want to adapt to the new
default.</li></ul><h2 id=fail--rvm-and-ruby-entreprise-edition--ree->FAIL : Rvm and Ruby Entreprise edition ( Ree )<a hidden class=anchor aria-hidden=true href=#fail--rvm-and-ruby-entreprise-edition--ree->#</a></h2><ul><li>Segfault !</li></ul><pre><code>ld: warning: directory not found for option '-L/opt/local/lib'
./ext/purelib.rb:2: [BUG] Segmentation fault
ruby 1.8.7 (2011-02-18 patchlevel 334) [i686-darwin11.0.0],
MBARI 0x6770, Ruby Enterprise Edition 2011.03
</code></pre><p><a href=https://gist.github.com/1115457>fulls logs</a></p><ul><li>Fixed by using gcc instead of llvm</li></ul><pre><code>rvm remove ree
export CC=/usr/bin/gcc-4.2
rvm install --force ree
</code></pre><p><a href=http://stackoverflow.com/questions/6804195/cant-install-ruby-enterprise-edition-with-rvm-on-osx-lion>StackOverflow
thread</a></p><h2 id=fail--rvm-and-postgresql-with-homebrew>FAIL : Rvm and Postgresql with Homebrew<a hidden class=anchor aria-hidden=true href=#fail--rvm-and-postgresql-with-homebrew>#</a></h2><ul><li>Fail to exec the <em>Postgresql</em> recipe :</li></ul><pre><code>Error: undefined method `strip' for #&lt;KegOnlyReason:0x10ac404b8&gt;
</code></pre><ul><li>I updated and relaunched <em>brew install postgresql</em> which ran smoothly
thanks to <a href=https://github.com/mxcl/homebrew/commit/20d2edf18deefb6d6439d415625f506c662dcba2>this
fix</a></li></ul><h2 id=fail--fullscreen->FAIL : Fullscreen :<a hidden class=anchor aria-hidden=true href=#fail--fullscreen->#</a></h2><ul><li>Can&rsquo;t use cmd+` to alternate windows while in fullscreen, this isn&rsquo;t
vital but it&rsquo;s quite annoying.</li></ul><h2 id=finally>Finally<a hidden class=anchor aria-hidden=true href=#finally>#</a></h2><p>As I wasn&rsquo;t expecting everything to work for the first time, those small
issues did not upset me and weren&rsquo;t hard to fix. I laughed hard at
myself for the macfuse failed surgery where I
can only blame myself.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://jhchabran.dev/tags/osx/>OSX</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2021 <a href=http://jhchabran.dev/>jhchabran</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>